<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fase 5: Cuestionario Interactivo - Suba en Sintonía</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: #f8f9fa;
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            color: white;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1.2em;
            font-weight: 300;
        }

        /* BOTONES DE NAVEGACIÓN */
        .navigation-buttons-quiz {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 30px 0;
            gap: 20px;
        }

        .nav-btn-quiz {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn-quiz:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .nav-btn-quiz.home {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            box-shadow: 0 4px 15px rgba(149, 165, 166, 0.3);
        }

        .nav-btn-quiz.home:hover {
            box-shadow: 0 6px 20px rgba(149, 165, 166, 0.4);
        }

        .nav-btn-quiz.prev {
            background: linear-gradient(45deg, #e67e22, #d35400);
            box-shadow: 0 4px 15px rgba(230, 126, 34, 0.3);
        }

        .nav-btn-quiz.prev:hover {
            box-shadow: 0 6px 20px rgba(230, 126, 34, 0.4);
        }

        .nav-btn-quiz.final {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            box-shadow: 0 4px 15px rgba(155, 89, 182, 0.3);
        }

        .nav-btn-quiz.final:hover {
            box-shadow: 0 6px 20px rgba(155, 89, 182, 0.4);
            size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
            font-weight: 300;
        }

        .phase-title {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.3);
        }

        .quiz-intro {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .quiz-icon {
            font-size: 80px;
            margin-bottom: 20px;
            animation: quizPulse 2s ease-in-out infinite;
        }

        @keyframes quizPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            border-radius: 10px;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            color: #2c3e50;
            font-weight: bold;
        }

        .question-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .question-container.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            0% { opacity: 0; transform: translateX(50px); }
            100% { opacity: 1; transform: translateX(0); }
        }

        .question-number {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 20px;
        }

        .question-text {
            font-size: 20px;
            color: #2c3e50;
            margin-bottom: 25px;
            line-height: 1.4;
            font-weight: bold;
        }

        .options-container {
            display: grid;
            gap: 15px;
        }

        .option {
            background: white;
            border: 3px solid #ecf0f1;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .option:hover {
            border-color: #9b59b6;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .option.selected {
            border-color: #3498db;
            background: rgba(52, 152, 219, 0.1);
        }

        .option.correct {
            border-color: #2ecc71;
            background: rgba(46, 204, 113, 0.1);
            animation: correctPulse 0.6s ease-in-out;
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            animation: incorrectShake 0.6s ease-in-out;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .option-letter {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 35px;
            height: 35px;
            background: #9b59b6;
            color: white;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            font-size: 16px;
        }

        .option.correct .option-letter {
            background: #2ecc71;
        }

        .option.incorrect .option-letter {
            background: #e74c3c;
        }

        .option-text {
            flex: 1;
            font-size: 16px;
            line-height: 1.4;
        }

        .feedback-container {
            margin-top: 20px;
            padding: 20px;
            border-radius: 15px;
            display: none;
        }

        .feedback-container.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }

        .feedback-container.correct {
            background: rgba(46, 204, 113, 0.1);
            border: 2px solid #2ecc71;
        }

        .feedback-container.incorrect {
            background: rgba(231, 76, 60, 0.1);
            border: 2px solid #e74c3c;
        }

        .feedback-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .feedback-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .feedback-text {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .correct-answer {
            background: rgba(46, 204, 113, 0.2);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #2ecc71;
            margin-bottom: 15px;
        }

        .correct-answer strong {
            color: #2ecc71;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .nav-btn.next {
            background: linear-gradient(45deg, #2ecc71, #27ae60);
            box-shadow: 0 4px 15px rgba(46, 204, 113, 0.3);
        }

        .nav-btn.next:hover:not(:disabled) {
            box-shadow: 0 6px 20px rgba(46, 204, 113, 0.4);
        }

        /* RESULTADOS FINALES */
        .results-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            text-align: center;
            display: none;
        }

        .results-container.show {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        .results-icon {
            font-size: 100px;
            margin-bottom: 20px;
        }

        .results-title {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .score-display {
            font-size: 48px;
            font-weight: bold;
            margin: 20px 0;
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .performance-message {
            font-size: 18px;
            color: #7f8c8d;
            margin-bottom: 30px;
            line-height: 1.5;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-item {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 28px;
            font-weight: bold;
            color: #9b59b6;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .retry-btn {
            background: linear-gradient(45deg, #e67e22, #d35400);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(230, 126, 34, 0.3);
            margin-top: 20px;
        }

        .retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(230, 126, 34, 0.4);
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2em;
            }

            .question-text {
                font-size: 18px;
            }

            .option {
                padding: 15px;
            }

            .navigation-buttons {
                flex-direction: column;
                gap: 15px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎵 Suba en Sintonía 🌿</h1>
            <p>Un Desafío por el Silencio y la Naturaleza</p>
        </div>

        <div class="phase-title">
            <h2>Fase 5: Evaluación de Conocimientos</h2>
            <p>Pon a prueba todo lo que has aprendido sobre contaminación sonora</p>
        </div>

        <!-- INTRODUCCIÓN AL CUESTIONARIO -->
        <div class="quiz-intro" id="quizIntro">
            <div class="quiz-icon">🧠</div>
            <h3>¡Hora de demostrar tus conocimientos!</h3>
            <p style="margin: 20px 0; font-size: 16px; line-height: 1.5;">
                Has completado un increíble viaje de aprendizaje sobre la contaminación sonora en Suba. 
                Ahora es momento de evaluar todo lo que has aprendido con este cuestionario interactivo.
            </p>
            <div style="background: rgba(155, 89, 182, 0.1); padding: 20px; border-radius: 15px; margin: 20px 0;">
                <h4 style="color: #9b59b6; margin-bottom: 15px;">📋 Instrucciones:</h4>
                <ul style="text-align: left; max-width: 500px; margin: 0 auto; color: #7f8c8d;">
                    <li>Lee cada pregunta cuidadosamente</li>
                    <li>Selecciona la opción que consideres correcta</li>
                    <li>Recibirás retroalimentación inmediata</li>
                    <li>Si te equivocas, aprenderás la respuesta correcta</li>
                    <li>¡No te preocupes, puedes intentar las veces que quieras!</li>
                </ul>
            </div>
            <button class="nav-btn next" onclick="startQuiz()">
                🚀 Comenzar Cuestionario
            </button>
        </div>

        <!-- BARRA DE PROGRESO -->
        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Pregunta 1 de 10</div>
        </div>

        <!-- CONTENEDOR DE PREGUNTAS -->
        <div class="question-container" id="questionContainer">
            <!-- Las preguntas se generarán dinámicamente aquí -->
        </div>

        <!-- NAVEGACIÓN -->
        <div class="navigation-buttons" id="navigationButtons" style="display: none;">
            <button class="nav-btn" id="prevBtn" onclick="previousQuestion()" disabled>
                ⬅️ Anterior
            </button>
            <button class="nav-btn next" id="nextBtn" onclick="nextQuestion()" disabled>
                Siguiente ➡️
            </button>
        </div>

        <!-- RESULTADOS FINALES -->
        <div class="results-container" id="resultsContainer">
            <!-- Los resultados se mostrarán aquí -->
        </div>
    </div>

    <script>
        // BASE DE DATOS DE PREGUNTAS
        const questions = [
            {
                id: 1,
                question: "¿Cuál es la definición más precisa de ruido según el Profesor Raes?",
                options: [
                    "Cualquier sonido que supere los 60 decibeles",
                    "Un sonido no deseado o molesto que puede producir efectos fisiológicos y psicológicos no deseados",
                    "Únicamente los sonidos producidos por maquinaria industrial",
                    "Solo los sonidos que duran más de 30 minutos continuos"
                ],
                correct: 1,
                explanation: "Según el Profesor Raes, el ruido se define como un sonido no deseado o molesto e intempestivo que puede producir efectos fisiológicos y psicológicos no deseados. Son las circunstancias subjetivas de los receptores las que determinan la calificación de ruido."
            },
            {
                id: 2,
                question: "¿A partir de qué nivel de decibelios se considera que el ruido puede dañar irreversiblemente la audición?",
                options: [
                    "70 dB",
                    "80 dB", 
                    "85 dB",
                    "90 dB"
                ],
                correct: 2,
                explanation: "La exposición a ruidos superiores a 85 dB puede dañar irreversiblemente las células ciliadas del oído interno, causando hipoacusia permanente. Este es el nivel típico de una vía principal con tráfico intenso."
            },
            {
                id: 3,
                question: "¿Cuál de estos efectos NO es una consecuencia directa de la contaminación sonora en estudiantes?",
                options: [
                    "Reducción de la capacidad de concentración",
                    "Mejora en las habilidades matemáticas",
                    "Fatiga crónica y estrés",
                    "Dificultades para escuchar a los profesores"
                ],
                correct: 1,
                explanation: "La contaminación sonora NO mejora las habilidades matemáticas. Por el contrario, interfiere con la concentración, causa fatiga y estrés, y dificulta la comunicación en el aula, afectando negativamente el rendimiento académico."
            },
            {
                id: 4,
                question: "¿Qué solución es más efectiva para reducir el ruido de construcción en zonas escolares?",
                options: [
                    "Ignorar el problema hasta que termine la obra",
                    "Implementar horarios restringidos para trabajos ruidosos y usar barreras acústicas",
                    "Trasladar temporalmente todas las clases a otros lugares",
                    "Aumentar el volumen de los sistemas de audio de las aulas"
                ],
                correct: 1,
                explanation: "La combinación de horarios restringidos (evitando horas de clase) y barreras acústicas es la solución más efectiva. Esto reduce el impacto directo en el proceso educativo mientras implementa medidas técnicas de mitigación."
            },
            {
                id: 5,
                question: "Los pavimentos fonoabsorbentes son más efectivos para reducir:",
                options: [
                    "El ruido de los motores de los vehículos",
                    "El ruido de las bocinas y claxons",
                    "El ruido de rodadura de los neumáticos",
                    "El ruido de las motocicletas únicamente"
                ],
                correct: 2,
                explanation: "Los pavimentos fonoabsorbentes (como el asfalto poroso) son especialmente efectivos para reducir el ruido de rodadura de los neumáticos, que es una fuente importante de contaminación sonora en las vías urbanas."
            },
            {
                id: 6,
                question: "¿Cuál es el principal impacto de la contaminación sonora en los humedales de Suba?",
                options: [
                    "Mejora la comunicación entre las especies",
                    "No tiene ningún efecto en la vida silvestre",
                    "Interfiere con la comunicación de aves y altera el comportamiento de la fauna",
                    "Solo afecta a los peces, no a las aves"
                ],
                correct: 2,
                explanation: "La contaminación sonora interfiere gravemente con la comunicación de las aves (cantos de apareamiento y llamadas de alerta) y altera el comportamiento de toda la fauna, disrumpiendo el equilibrio natural del ecosistema."
            },
            {
                id: 7,
                question: "¿Qué hormona se eleva en el cuerpo humano debido a la exposición prolongada al ruido?",
                options: [
                    "Insulina",
                    "Cortisol",
                    "Melatonina", 
                    "Dopamina"
                ],
                correct: 1,
                explanation: "El cortisol es la hormona del estrés que se eleva debido a la exposición prolongada al ruido, manteniéndonos en un estado de alerta constante que puede llevar a trastornos de ansiedad y problemas de salud."
            },
            {
                id: 8,
                question: "¿Cuál es la solución más viable para una comunidad con recursos limitados?",
                options: [
                    "Comprar ventanas acústicas para todos los edificios",
                    "Insonorizar toda la maquinaria de construcción",
                    "Implementar campañas educativas y señalización de 'Zona de Silencio'",
                    "Construir muros de concreto de 5 metros de altura"
                ],
                correct: 2,
                explanation: "Las campañas educativas y la señalización son soluciones viables y de bajo costo que pueden generar cambios de comportamiento significativos en la comunidad, siendo más accesibles que las soluciones de alta tecnología."
            },
            {
                id: 9,
                question: "¿Qué efecto tiene la vegetación densa en la reducción del ruido?",
                options: [
                    "No tiene ningún efecto",
                    "Solo funciona con plantas específicas importadas",
                    "Actúa como barrera natural absorbiendo y atenuando el sonido",
                    "Amplifica el ruido haciéndolo más molesto"
                ],
                correct: 2,
                explanation: "La vegetación densa actúa como una barrera natural que absorbe y atenúa el sonido. Los árboles y arbustos pueden reducir significativamente los niveles de ruido mientras proporcionan beneficios ambientales adicionales."
            },
            {
                id: 10,
                question: "¿Cuál es el objetivo principal del proyecto 'Suba en Sintonía'?",
                options: [
                    "Eliminar completamente todos los sonidos de Suba",
                    "Generar conciencia y proponer soluciones viables para reducir la contaminación sonora",
                    "Prohibir toda actividad que genere ruido",
                    "Construir estudios de grabación en toda la localidad"
                ],
                correct: 1,
                explanation: "El objetivo de 'Suba en Sintonía' es generar conciencia sobre la problemática de la contaminación sonora y proponer soluciones viables y sostenibles que estén al alcance de la comunidad, devolviendo la tranquilidad a Suba."
            }
        ];

        // VARIABLES DEL CUESTIONARIO
        let currentQuestion = 0;
        let userAnswers = [];
        let score = 0;
        let quizStarted = false;

        // INICIAR CUESTIONARIO
        function startQuiz() {
            document.getElementById('quizIntro').style.display = 'none';
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('navigationButtons').style.display = 'flex';
            quizStarted = true;
            showQuestion(0);
        }

        // MOSTRAR PREGUNTA
        function showQuestion(questionIndex) {
            const question = questions[questionIndex];
            const container = document.getElementById('questionContainer');
            
            // Actualizar progreso
            updateProgress();
            
            container.innerHTML = `
                <div class="question-number">Pregunta ${questionIndex + 1} de ${questions.length}</div>
                <div class="question-text">${question.question}</div>
                <div class="options-container">
                    ${question.options.map((option, index) => `
                        <div class="option" onclick="selectOption(${index})" data-option="${index}">
                            <div style="display: flex; align-items: center;">
                                <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
                <div class="feedback-container" id="feedback"></div>
            `;
            
            container.classList.add('active');
            
            // Restaurar respuesta anterior si existe
            if (userAnswers[questionIndex] !== undefined) {
                const selectedOption = container.querySelector(`[data-option="${userAnswers[questionIndex]}"]`);
                if (selectedOption) {
                    selectedOption.classList.add('selected');
                    showFeedback(userAnswers[questionIndex], questionIndex);
                }
            }
            
            updateNavigationButtons();
        }

        // SELECCIONAR OPCIÓN
        function selectOption(optionIndex) {
            const question = questions[currentQuestion];
            const options = document.querySelectorAll('.option');
            
            // Remover selección anterior
            options.forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Marcar opción seleccionada
            const selectedOption = document.querySelector(`[data-option="${optionIndex}"]`);
            selectedOption.classList.add('selected');
            
            // Guardar respuesta
            userAnswers[currentQuestion] = optionIndex;
            
            // Mostrar feedback
            showFeedback(optionIndex, currentQuestion);
            
            // Actualizar botones de navegación
            updateNavigationButtons();
        }

        // MOSTRAR RETROALIMENTACIÓN
        function showFeedback(selectedOption, questionIndex) {
            const question = questions[questionIndex];
            const isCorrect = selectedOption === question.correct;
            const feedback = document.getElementById('feedback');
            const options = document.querySelectorAll('.option');
            
            // Marcar respuesta correcta e incorrecta
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedOption && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            // Mostrar feedback
            feedback.className = `feedback-container show ${isCorrect ? 'correct' : 'incorrect'}`;
            feedback.innerHTML = `
                <div class="feedback-icon">${isCorrect ? '✅' : '❌'}</div>
                <div class="feedback-title">${isCorrect ? '¡Correcto!' : 'Incorrecto'}</div>
                <div class="feedback-text">
                    ${isCorrect ? 
                        '¡Excelente! Has demostrado un buen entendimiento del tema.' : 
                        'No te preocupes, aquí tienes la explicación:'
                    }
                </div>
                ${!isCorrect ? `
                    <div class="correct-answer">
                        <strong>Respuesta correcta: ${String.fromCharCode(65 + question.correct)}) ${question.options[question.correct]}</strong>
                    </div>
                ` : ''}
                <div style="background: rgba(155, 89, 182, 0.1); padding: 15px; border-radius: 10px; border-left: 4px solid #9b59b6;">
                    <strong>Explicación:</strong><br>
                    ${question.explanation}
                </div>
            `;
        }

        // ACTUALIZAR PROGRESO
        function updateProgress() {
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const percentage = ((currentQuestion) / questions.length) * 100;
            
            progressFill.style.width = `${percentage}%`;
            progressText.textContent = `Pregunta ${currentQuestion + 1} de ${questions.length}`;
        }

        // ACTUALIZAR BOTONES DE NAVEGACIÓN
        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentQuestion === 0;
            
            if (currentQuestion === questions.length - 1) {
                nextBtn.textContent = 'Ver Resultados 🏆';
                nextBtn.disabled = userAnswers[currentQuestion] === undefined;
            } else {
                nextBtn.textContent = 'Siguiente ➡️';
                nextBtn.disabled = userAnswers[currentQuestion] === undefined;
            }
        }

        // PREGUNTA ANTERIOR
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                showQuestion(currentQuestion);
            }
        }

        // SIGUIENTE PREGUNTA
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                showQuestion(currentQuestion);
            } else {
                showResults();
            }
        }

        // MOSTRAR RESULTADOS
        function showResults() {
            // Calcular puntuación
            score = 0;
            userAnswers.forEach((answer, index) => {
                if (answer === questions[index].correct) {
                    score++;
                }
            });

            const percentage = Math.round((score / questions.length) * 100);
            
            // Ocultar elementos del cuestionario
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('navigationButtons').style.display = 'none';
            
            // Determinar mensaje de rendimiento
            let performanceMessage, resultsIcon;
            if (percentage >= 90) {
                performanceMessage = "¡Excelente! Eres un verdadero experto en contaminación sonora. Has demostrado un conocimiento excepcional del tema.";
                resultsIcon = "🏆";
            } else if (percentage >= 80) {
                performanceMessage = "¡Muy bien! Tienes un buen dominio del tema. Solo algunos detalles por pulir.";
                resultsIcon = "🥇";
            } else if (percentage >= 70) {
                performanceMessage = "¡Bien hecho! Has aprendido mucho, pero hay algunos conceptos que podrías repasar.";
                resultsIcon = "🥈";
            } else if (percentage >= 60) {
                performanceMessage = "Vas por buen camino, pero te recomendamos revisar los materiales nuevamente para fortalecer tus conocimientos.";
                resultsIcon = "🥉";
            } else {
                performanceMessage = "Te recomendamos revisar todo el material del proyecto antes de intentar nuevamente. ¡No te desanimes, el aprendizaje es un proceso!";
                resultsIcon = "📚";
            }

            // Mostrar resultados
            const resultsContainer = document.getElementById('resultsContainer');
            resultsContainer.innerHTML = `
                <div class="results-icon">${resultsIcon}</div>
                <div class="results-title">¡Cuestionario Completado!</div>
                <div class="score-display">${score}/${questions.length}</div>
                <div style="font-size: 24px; color: #9b59b6; font-weight: bold; margin-bottom: 20px;">
                    ${percentage}% de aciertos
                </div>
                <div class="performance-message">${performanceMessage}</div>
                
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-number">${score}</div>
                        <div class="stat-label">Correctas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">${questions.length - score}</div>
                        <div class="stat-label">Incorrectas</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">${percentage}%</div>
                        <div class="stat-label">Puntuación</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-number">${questions.length}</div>
                        <div class="stat-label">Total</div>
                    </div>
                </div>

                <div style="background: rgba(155, 89, 182, 0.1); padding: 20px; border-radius: 15px; margin: 30px 0;">
                    <h4 style="color: #9b59b6; margin-bottom: 15px;">🎓 ¡Felicitaciones!</h4>
                    <p style="color: #7f8c8d; line-height: 1.5;">
                        Has completado exitosamente todas las fases del proyecto "Suba en Sintonía". 
                        Ahora eres un verdadero Detective Sonoro y agente de cambio en tu comunidad.
                        ¡Sigue aplicando todo lo que has aprendido!
                    </p>
                </div>

                <button class="retry-btn" onclick="restartQuiz()">
                    🔄 Intentar Nuevamente
                </button>
                
                <button class="nav-btn next" onclick="downloadCertificate()" style="margin-top: 15px; width: 100%;">
                    📜 Descargar Certificado de Finalización
                </button>
            `;
            
            resultsContainer.classList.add('show');
        }

        // REINICIAR CUESTIONARIO
        function restartQuiz() {
            currentQuestion = 0;
            userAnswers = [];
            score = 0;
            quizStarted = true;
            
            // Ocultar resultados
            document.getElementById('resultsContainer').classList.remove('show');
            document.getElementById('resultsContainer').style.display = 'none';
            
            // Mostrar elementos del cuestionario
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('navigationButtons').style.display = 'flex';
            document.getElementById('questionContainer').style.display = 'block';
            
            // Limpiar cualquier clase activa anterior
            document.getElementById('questionContainer').classList.remove('active');
            
            // Mostrar la primera pregunta
            setTimeout(() => {
                showQuestion(0);
            }, 100);
        }

        // DESCARGAR CERTIFICADO
        function downloadCertificate() {
            const now = new Date();
            const certificate = `
🏅 CERTIFICADO DE FINALIZACIÓN 🏅

DETECTIVE SONORO CERTIFICADO

Este certificado se otorga a:
[TU NOMBRE]

Por haber completado exitosamente el proyecto educativo:
"SUBA EN SINTONÍA: UN DESAFÍO POR EL SILENCIO Y LA NATURALEZA"

RESULTADOS DEL CUESTIONARIO FINAL:
✅ Puntuación obtenida: ${score}/${questions.length} (${Math.round((score/questions.length)*100)}%)
✅ Fecha de finalización: ${now.toLocaleDateString()}

FASES COMPLETADAS:
✅ Fase 1: Exploración del Problema - Mapa Sonoro Interactivo
✅ Fase 2: Estrategias - Investigación y Comprensión Profunda  
✅ Fase 3: El Silencio Robado - Propuesta de Soluciones
✅ Fase 4: Actúa y Reflexiona - Planificación e Implementación
✅ Fase 5: Evaluación de Conocimientos - Cuestionario Interactivo

COMPETENCIAS DESARROLLADAS:
🧠 Comprensión de la contaminación sonora y sus efectos
🔬 Investigación y análisis de problemas ambientales
💡 Creatividad en el diseño de soluciones sostenibles
👥 Trabajo colaborativo y pensamiento crítico
🌱 Conciencia ambiental y responsabilidad social

Has demostrado ser un verdadero AGENTE DE CAMBIO
en la protección del ambiente sonoro de Suba.

Institución: [Tu Colegio]
Proyecto: Suba en Sintonía

¡Continúa siendo un guardián del silencio en tu comunidad!

🌿🎵🏆🎵🌿
            `;

            // Crear y descargar archivo
            const blob = new Blob([certificate], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Certificado_Suba_en_Sintonia.txt';
            a.click();
            window.URL.revokeObjectURL(url);

            // Mostrar mensaje de confirmación
            alert('📜 ¡Certificado descargado exitosamente!\n\n¡Felicitaciones por completar todo el proyecto "Suba en Sintonía"!');
        }

        // INICIALIZACIÓN
        window.addEventListener('load', function() {
            // Agregar efectos de entrada
            const elements = document.querySelectorAll('.quiz-intro, .header');
            elements.forEach((element, index) => {
                element.style.opacity = '0';
                element.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    element.style.transition = 'all 0.6s ease';
                    element.style.opacity = '1';
                    element.style.transform = 'translateY(0)';
                }, index * 200);
            });
        });
    </script>

    <!-- BOTONES DE NAVEGACIÓN -->
    <div class="navigation-buttons-quiz">
        <div style="display: flex; gap: 15px;">
            <a href="../index.html" class="nav-btn-quiz home">
                🏠 Inicio
            </a>
            <a href="../fase4/index.html" class="nav-btn-quiz prev">
                ⬅️ Fase 4
            </a>
        </div>
        <div style="text-align: center; color: #7f8c8d;">
            <small>Fase 5 de 5 - ¡Evaluación Final!</small>
        </div>
        <div class="nav-btn-quiz final" style="opacity: 0.6; cursor: not-allowed;">
            🎓 ¡Proyecto Completo!
        </div>
    </div>

</body>
</html>